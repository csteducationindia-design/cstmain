<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Portal</title>
    <link rel="manifest" href="/static/manifest.json">
    <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
    <link as="style" href="https://fonts.googleapis.com/css2?display=swap&family=Inter:wght@400;500;700;900" onload="this.rel='stylesheet'" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>tailwind.config = { darkMode: "class", theme: { extend: { colors: { "primary": "#1173d4" }, fontFamily: { "display": ["Inter"] } } } }</script>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
</head>
<body class="bg-slate-50 dark:bg-slate-900 font-display text-slate-800 dark:text-slate-200">
<div class="flex min-h-screen">
    <aside class="w-64 bg-white dark:bg-slate-900 border-r border-slate-200 dark:border-slate-800 flex flex-col shadow-lg">
        <div class="p-6"><h1 class="text-2xl font-bold text-slate-900 dark:text-white">Institute Teacher</h1></div>
        <nav class="flex-1 px-4 py-2 space-y-1">
            <a href="#courses" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg bg-primary/10 text-primary"><span class="material-symbols-outlined">book</span><span class="text-sm font-medium">My Courses</span></a>
            <a href="#attendance" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-slate-700 hover:bg-slate-100"><span class="material-symbols-outlined">how_to_reg</span><span class="text-sm font-medium">Mark Attendance</span></a>
            <a href="#notifications" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-slate-700 hover:bg-slate-100"><span class="material-symbols-outlined">notifications_active</span><span class="text-sm font-medium">Notifications</span></a>
            <a href="#share-notes" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-slate-700 hover:bg-slate-100"><span class="material-symbols-outlined">upload_file</span><span class="text-sm font-medium">Share Notes</span></a>
            <a href="#reports" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-slate-700 hover:bg-slate-100"><span class="material-symbols-outlined">analytics</span><span class="text-sm font-medium">View Reports</span></a>
            <a href="#announcements" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-slate-700 hover:bg-slate-100"><span class="material-symbols-outlined">campaign</span><span class="text-sm font-medium">Announcements</span></a>
            <button id="install-app-btn" class="hidden w-full flex items-center gap-3 px-4 py-2 rounded-lg text-green-600 hover:bg-green-50 font-medium mt-4"><span class="material-symbols-outlined">download</span><span class="text-sm">Install App</span></button>
        </nav>
        <div class="p-6 border-t border-slate-200"><button id="logout-btn" class="w-full bg-red-600 text-white py-2 px-4 rounded-lg text-sm hover:bg-red-700">Logout</button></div>
    </aside>
    <main class="flex-1 p-8">
        <div class="max-w-7xl mx-auto">
            <header class="mb-8"><h1 id="teacher-welcome" class="text-4xl font-bold text-slate-900 dark:text-white">Welcome!</h1></header>
            <div id="content-courses" class="content-section"></div>
            <div id="content-attendance" class="content-section hidden"></div>
            <div id="content-notifications" class="content-section hidden"></div>
            <div id="content-share-notes" class="content-section hidden"></div>
            <div id="content-reports" class="content-section hidden"></div>
            <div id="content-announcements" class="content-section hidden"></div>
        </div>
    </main>
</div>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-messaging-compat.js"></script>
<script>
    const API_ORIGIN = window.location.origin;
    const API_BASE_URL = API_ORIGIN + '/api';
    
    // PWA INSTALL
    let deferredPrompt;
    const installBtn = document.getElementById('install-app-btn');
    window.addEventListener('beforeinstallprompt', (e) => { e.preventDefault(); deferredPrompt = e; installBtn.classList.remove('hidden'); });
    installBtn.addEventListener('click', async () => { if(deferredPrompt){ deferredPrompt.prompt(); deferredPrompt = null; } });

    // FIREBASE INIT
    function initFirebase() {
        try {
            const firebaseConfig = {
                apiKey: "AIzaSyBkZEHM9fXRoCYSgEW-hk_lN7sL_nSLDfU",
                authDomain: "cst-institute-app.firebaseapp.com",
                projectId: "cst-institute-app",
                storageBucket: "cst-institute-app.firebasestorage.app",
                messagingSenderId: "485166460200",
                appId: "1:485166460200:web:4eae20e2010ab92baeb41d"
            };
            if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
            const messaging = firebase.messaging();
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/firebase-messaging-sw.js').then((reg) => {
                    Notification.requestPermission().then((perm) => {
                        if (perm === 'granted') {
                            messaging.getToken({ vapidKey: 'BBOMxvKvbEs_t9ykKBa2zIewzCzD6FCbm9rxc8a9eWl2kjjH5vyTSH6TeQMksZ_OGl5jZyQpU2wBcf-KsZN1uko', serviceWorkerRegistration: reg })
                            .then((token) => { if(token) fetch('/api/save_fcm_token', {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({token})}); });
                        }
                    });
                });
            }
        } catch(e){ console.log(e); }
    }
    setTimeout(initFirebase, 2000);
    
    // (Keep previous logic for loading courses/attendance/notes - omitted for brevity but assume included)
    // Just ensure you copy the full JS logic block from the previous detailed teacher.html if you need the inner workings.
</script>
</body>
</html>